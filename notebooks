main proj.ipynb

{"metadata":{"kernelspec":{"language":"python","display_name":"Python 3","name":"python3"},"language_info":{"name":"python","version":"3.11.13","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"},"kaggle":{"accelerator":"none","dataSources":[{"sourceId":11124361,"sourceType":"datasetVersion","datasetId":6937364}],"dockerImageVersionId":31153,"isInternetEnabled":false,"language":"python","sourceType":"notebook","isGpuEnabled":false}},"nbformat_minor":4,"nbformat":4,"cells":[{"cell_type":"code","source":"# Basic and advanced libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Machine Learning\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder, StandardScaler\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score\n\n# Deep Learning\nimport tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Conv1D, MaxPooling1D, Flatten, Dense, Dropout, BatchNormalization\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:29.171577Z","iopub.execute_input":"2025-10-27T11:01:29.171929Z","iopub.status.idle":"2025-10-27T11:01:34.130910Z","shell.execute_reply.started":"2025-10-27T11:01:29.171904Z","shell.execute_reply":"2025-10-27T11:01:34.129997Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Load the data\ndf = pd.read_csv('/kaggle/input/india-road-accident-dataset-predictive-analysis/accident_prediction_india.csv')\ndf.head()\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.132903Z","iopub.execute_input":"2025-10-27T11:01:34.133645Z","iopub.status.idle":"2025-10-27T11:01:34.191291Z","shell.execute_reply.started":"2025-10-27T11:01:34.133608Z","shell.execute_reply":"2025-10-27T11:01:34.190206Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Basic information about dataset\nprint(\"Shape:\", df.shape)\nprint(\"\\nData Types:\\n\", df.dtypes)\nprint(\"\\nMissing Values:\\n\", df.isnull().sum())\nprint(\"\\nTarget Distribution:\\n\", df['Accident Severity'].value_counts())\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.192085Z","iopub.execute_input":"2025-10-27T11:01:34.192347Z","iopub.status.idle":"2025-10-27T11:01:34.204733Z","shell.execute_reply.started":"2025-10-27T11:01:34.192328Z","shell.execute_reply":"2025-10-27T11:01:34.203401Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Remove columns that are completely empty\ndf = df.dropna(axis=1, how='all')\n\n# Fill missing values with most frequent entry in each column\nimputer = SimpleImputer(strategy='most_frequent')\ndf_imputed = pd.DataFrame(imputer.fit_transform(df), columns=df.columns)\n\n# Remove unwanted spaces in column names\ndf_imputed.columns = df_imputed.columns.str.strip()\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.205828Z","iopub.execute_input":"2025-10-27T11:01:34.206154Z","iopub.status.idle":"2025-10-27T11:01:34.244353Z","shell.execute_reply.started":"2025-10-27T11:01:34.206118Z","shell.execute_reply":"2025-10-27T11:01:34.243294Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Encode the target variable\nle = LabelEncoder()\ndf_imputed['Accident Severity'] = le.fit_transform(df_imputed['Accident Severity'])\n\n# Define categorical columns for one-hot encoding\ncategorical_features = [\n    'State Name', 'City Name', 'Month', 'Day of Week', 'Time of Day',\n    'Vehicle Type Involved', 'Weather Conditions', 'Road Type', 'Road Condition',\n    'Lighting Conditions', 'Traffic Control Presence', 'Driver Gender',\n    'Driver License Status', 'Alcohol Involvement', 'Accident Location Details'\n]\n\n# Convert to string (important for dummy creation)\ndf_imputed[categorical_features] = df_imputed[categorical_features].astype(str)\n\n# One-hot encode categorical variables\ndf_encoded = pd.get_dummies(df_imputed, columns=categorical_features)\nprint(\"Data encoded successfully!\")\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.246550Z","iopub.execute_input":"2025-10-27T11:01:34.246828Z","iopub.status.idle":"2025-10-27T11:01:34.285959Z","shell.execute_reply.started":"2025-10-27T11:01:34.246808Z","shell.execute_reply":"2025-10-27T11:01:34.285084Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Split into features and target\nX = df_encoded.drop('Accident Severity', axis=1)\ny = df_encoded['Accident Severity']\n\n# Train-test split (stratified)\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42, stratify=y\n)\n\nprint(\"Training set:\", X_train.shape)\nprint(\"Testing set:\", X_test.shape)\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.286769Z","iopub.execute_input":"2025-10-27T11:01:34.287012Z","iopub.status.idle":"2025-10-27T11:01:34.311361Z","shell.execute_reply.started":"2025-10-27T11:01:34.286992Z","shell.execute_reply":"2025-10-27T11:01:34.310148Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"scaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.312328Z","iopub.execute_input":"2025-10-27T11:01:34.312657Z","iopub.status.idle":"2025-10-27T11:01:34.686149Z","shell.execute_reply.started":"2025-10-27T11:01:34.312623Z","shell.execute_reply":"2025-10-27T11:01:34.684973Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"model = RandomForestClassifier(n_estimators=100, random_state=42, class_weight='balanced')\nmodel.fit(X_train_scaled, y_train)\nprint(\"Random Forest model trained successfully!\")\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:34.687220Z","iopub.execute_input":"2025-10-27T11:01:34.687513Z","iopub.status.idle":"2025-10-27T11:01:36.298368Z","shell.execute_reply.started":"2025-10-27T11:01:34.687490Z","shell.execute_reply":"2025-10-27T11:01:36.297430Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"y_pred = model.predict(X_test_scaled)\n\nprint(\"Accuracy:\", round(accuracy_score(y_test, y_pred) * 100, 2), \"%\")\nprint(\"\\nConfusion Matrix:\\n\", confusion_matrix(y_test, y_pred))\nprint(\"\\nClassification Report:\\n\", classification_report(y_test, y_pred, target_names=le.classes_))\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:36.299267Z","iopub.execute_input":"2025-10-27T11:01:36.299489Z","iopub.status.idle":"2025-10-27T11:01:36.349738Z","shell.execute_reply.started":"2025-10-27T11:01:36.299471Z","shell.execute_reply":"2025-10-27T11:01:36.348691Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"y_pred = model.predict(X_test_scaled)\nprint('Accuracy:', accuracy_score(y_test, y_pred))\nprint(confusion_matrix(y_test, y_pred))\nprint(classification_report(y_test, y_pred, target_names=le.classes_))\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:36.350948Z","iopub.execute_input":"2025-10-27T11:01:36.351307Z","iopub.status.idle":"2025-10-27T11:01:36.400731Z","shell.execute_reply.started":"2025-10-27T11:01:36.351276Z","shell.execute_reply":"2025-10-27T11:01:36.399456Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# If required, output test predictions for submission in a Kaggle competition\npreds_df = pd.DataFrame({\n    'Index': X_test.index,\n    'Predicted_Severity': le.inverse_transform(y_pred)\n})\npreds_df.to_csv('submission.csv', index=False)\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:36.401536Z","iopub.execute_input":"2025-10-27T11:01:36.401773Z","iopub.status.idle":"2025-10-27T11:01:36.414818Z","shell.execute_reply.started":"2025-10-27T11:01:36.401756Z","shell.execute_reply":"2025-10-27T11:01:36.413795Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Display top 10 important features\nfeat_importances = pd.Series(model.feature_importances_, index=X.columns)\nfeat_importances.nlargest(10).plot(kind='barh')\nplt.show()\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:36.415773Z","iopub.execute_input":"2025-10-27T11:01:36.416082Z","iopub.status.idle":"2025-10-27T11:01:36.997606Z","shell.execute_reply.started":"2025-10-27T11:01:36.416057Z","shell.execute_reply":"2025-10-27T11:01:36.996627Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Conv1D, MaxPooling1D, Flatten, Dense, Dropout, BatchNormalization\n\n# reshape your feature matrix X_train to 3D (samples, time steps/features, 1)\nX_train_cnn = X_train_scaled.reshape(X_train_scaled.shape[0], X_train_scaled.shape[1], 1)\nX_test_cnn = X_test_scaled.reshape(X_test_scaled.shape[0], X_test_scaled.shape[1], 1)\n\nnum_classes = len(np.unique(y_train))\n\nmodel = Sequential([\n    Conv1D(32, kernel_size=3, activation='relu', input_shape=(X_train_cnn.shape[1], 1)),\n    BatchNormalization(),\n    MaxPooling1D(pool_size=2),\n    Dropout(0.2),\n\n    Conv1D(64, kernel_size=3, activation='relu'),\n    BatchNormalization(),\n    MaxPooling1D(pool_size=2),\n    Dropout(0.2),\n\n    Flatten(),\n    Dense(64, activation='relu'),\n    Dropout(0.3),\n\n    Dense(num_classes, activation='softmax')\n])\n\nmodel.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])\nmodel.summary()\n\n# Train the CNN model\nhistory = model.fit(X_train_cnn, y_train, epochs=20, batch_size=128, validation_data=(X_test_cnn, y_test))\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:01:36.998742Z","iopub.execute_input":"2025-10-27T11:01:36.999019Z","iopub.status.idle":"2025-10-27T11:03:16.631327Z","shell.execute_reply.started":"2025-10-27T11:01:36.999000Z","shell.execute_reply":"2025-10-27T11:03:16.630361Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"# Save the CNN model as an .h5 file\nmodel.save('accident_prediction_model.h5')\nprint(\"Model saved successfully as 'accident_prediction_model.h5'\")\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:11:37.386002Z","iopub.execute_input":"2025-10-27T11:11:37.386395Z","iopub.status.idle":"2025-10-27T11:11:37.479814Z","shell.execute_reply.started":"2025-10-27T11:11:37.386362Z","shell.execute_reply":"2025-10-27T11:11:37.478812Z"}},"outputs":[],"execution_count":null},{"cell_type":"code","source":"import joblib\n\n# Save the scaler and label encoder\njoblib.dump(scaler, 'scaler.pkl')\njoblib.dump(le, 'label_encoder.pkl')\n\nprint(\"âœ… Scaler and LabelEncoder saved successfully!\")\n","metadata":{"trusted":true,"execution":{"iopub.status.busy":"2025-10-27T11:18:24.983698Z","iopub.execute_input":"2025-10-27T11:18:24.984230Z","iopub.status.idle":"2025-10-27T11:18:24.992457Z","shell.execute_reply.started":"2025-10-27T11:18:24.984202Z","shell.execute_reply":"2025-10-27T11:18:24.991455Z"}},"outputs":[],"execution_count":null}]}
